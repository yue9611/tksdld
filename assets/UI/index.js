System.register("chunks:///_virtual/PlayerAssetBar.ts",["cc","./_rollupPluginModLoBabelHelpers.js","./GameEventType.ts","./GlobalEnum.ts","./Action3dManager.ts","./yyComponent.ts","./PlayerData.ts","./GlobalPool.ts"],(function(t){"use strict";var o,e,n,i,a,l,r,s,d,c,h,u,g,f,v,p,m,y,b,I;return{setters:[function(t){o=t.cclegacy,e=t.Label,n=t.Node,i=t.Prefab,a=t._decorator,l=t.v3,r=t.UITransform,s=t.Widget},function(t){d=t.applyDecoratedDescriptor,c=t.inheritsLoose,h=t.initializerDefineProperty,u=t.assertThisInitialized,g=t.defineProperty},function(t){f=t.EventType},function(t){v=t.GlobalEnum},function(t){p=t.default,m=t.ActionMngType},function(t){y=t.default},function(t){b=t.default},function(t){I=t.default}],execute:function(){var G,P,T,A,C,E,D,L,M,S;o._RF.push({},"08b7fQRKfNDVZa5QgqRT/Gw","PlayerAssetBar",void 0);var w=a,N=w.ccclass,U=w.property;t("default",(G=U(e),P=U(n),T=U(n),A=U(i),N((D=d((E=function(t){function o(){for(var o,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return o=t.call.apply(t,[this].concat(n))||this,h(u(o),"goldLabel",D,u(o)),g(u(o),"gold",void 0),h(u(o),"goldLayer",L,u(o)),h(u(o),"goldIconTargetNode",M,u(o)),h(u(o),"goldIconPrefab",S,u(o)),g(u(o),"cb",void 0),g(u(o),"addGoldStep",1),g(u(o),"goldIconCount",0),o}c(o,t);var e=o.prototype;return e.init=function(){this.initGoldIcon(),this.onEvents(),this.setData()},e.onEvents=function(){this.on(f.Common.PlayerDataEvent.playerDataChanged,this.onPlayerDataChanged,this),this.on(f.Common.UIEvent.playGoldAnim,this.playGoldAnim,this),this.on(f.LevelEvent.changeGoldPos,this.setGoldBarPos,this)},e.reset=function(){this.resetGoldIcon()},e.show=function(){this.node.active=!0,this.setData(),this.onEvents()},e.hide=function(){this.offEvents(),this.node.active=!1},e.setData=function(){var t=b.getData("gameData.asset");this.setGold(t.gold)},e.convertToString=function(t){return t.toString()},e.onPlayerDataChanged=function(t){switch(t.attribute){case"gameData.asset.gold":this.setGold(t.value)}},e.addGold=function(t){this.setGold(this.gold+t)},e.setGold=function(t){this.gold=t,this.goldLabel.string=this.convertToString(t)},e.initGoldIcon=function(){this.cb=null,I.createPool(this.goldIconPrefab.name,this.goldIconPrefab)},e.resetGoldIcon=function(){this.cb=null;for(var t=p.getMng(m.UI),o=this.goldLayer.children.length-1;o>=0;--o)t.stopAllActions(this.goldLayer.children[o]);I.putAllChildren(this.goldLayer,!0)},e.playGoldAnim=function(t){this.emit(f.Common.AudioEvent.playEffect,v.AudioClip.reward),this.resetGoldIcon(),this.emit(f.Common.UIEvent.showTouchMask),this.cb=t.cb;var o=l();t.startPos&&(o.x=t.startPos.x,o.y=t.startPos.y);this.goldIconCount=Math.round(10*Math.random())+20;var e=this.goldIconCount;t.gold?this.addGoldStep=Math.floor(t.gold/e):this.addGoldStep=1;for(var n=p.getMng(m.UI),i=0;i<e;i++){var a=I.get(this.goldIconPrefab.name);this.goldLayer.addChild(a),a.setPosition(o),a.setScale(1,1);var r=p.moveTo(.5,150*(Math.random()-.5)+o.x,150*(Math.random()-.5)+o.y,0);r.easing(p.easeOut(2)),n.runAction(a,r)}this.scheduleOnce(this.toTarget,.5)},e.toTarget=function(){var t=p.getMng(m.UI),o=this.goldIconTargetNode.getComponent(r).convertToWorldSpaceAR(l());o=this.node.getComponent(r).convertToNodeSpaceAR(o);for(var e=this.goldLayer.children.length,n=0;n<e;++n){var i=p.moveTo(1,o.x,o.y,0);i.easing(p.easeSinIn());var a=p.scaleTo(1,.5,.5,1);a.easing(p.easeSinIn());var s=p.spawn(i,a),d=p.delay(.06*(e-n+1)),c=p.callFun(this.onGoldParticleArrived,this),h=p.sequence(d,s,c);t.runAction(this.goldLayer.children[n],h)}},e.onGoldParticleArrived=function(){this.addGold(this.addGoldStep),this.emit(f.Common.AudioEvent.playEffect,v.AudioClip.gold),--this.goldIconCount<=0&&this.playFinish()},e.playFinish=function(){this.emit(f.Common.UIEvent.hideTouchMask),this.cb?this.cb():this.emit(f.Common.UIEvent.goldAnimPlayFinish),this.resetGoldIcon()},e.setGoldBarPos=function(t){void 0===t&&(t=!0),this.goldIconTargetNode.getComponent(s).enabled=!1;var o=this.goldIconTargetNode.getPosition();o.x=t?-327:-97;var e=p.moveTo(.3,o);p.getMng(m.UI).runAction(this.goldIconTargetNode,e)},o}(y)).prototype,"goldLabel",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=d(E.prototype,"goldLayer",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=d(E.prototype,"goldIconTargetNode",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=d(E.prototype,"goldIconPrefab",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=E))||C));o._RF.pop()}}}));

System.register("chunks:///_virtual/SkillBtn.ts",["cc","./_rollupPluginModLoBabelHelpers.js","./GameEventType.ts","./yyComponent.ts","./Loader.ts"],(function(t){"use strict";var o,i,e,n,s,r,l,c,h,u,a,d,f,p;return{setters:[function(t){o=t.cclegacy,i=t.Sprite,e=t._decorator,n=t.Color,s=t.color,r=t.SpriteFrame},function(t){l=t.applyDecoratedDescriptor,c=t.inheritsLoose,h=t.defineProperty,u=t.assertThisInitialized,a=t.initializerDefineProperty},function(t){d=t.EventType},function(t){f=t.default},function(t){p=t.default}],execute:function(){var S,C,m,b,g,v;o._RF.push({},"196e1rqPVFGh7fK050ntR2Z","SkillBtn",void 0);var y=e,T=y.ccclass,I=y.property;t("default",(S=I(i),C=I(i),T((g=l((b=function(t){function o(){for(var o,i=arguments.length,e=new Array(i),r=0;r<i;r++)e[r]=arguments[r];return o=t.call.apply(t,[this].concat(e))||this,h(u(o),"btnId",void 0),a(u(o),"img",g,u(o)),a(u(o),"coolSprite",v,u(o)),h(u(o),"skillId",0),h(u(o),"cooled",!0),h(u(o),"btnSprite",null),h(u(o),"touched",!1),h(u(o),"normalColor",n.WHITE),h(u(o),"darkColor",s(200,200,200,255)),o}c(o,t);var e=o.prototype;return e.init=function(){this.initCoolMask(),this.initCoolState(),this.initTouchState(),this.onEvents()},e.onEvents=function(){this.node.on("touchstart",this.onTouchStart,this),this.node.on("touchend",this.onTouchEnd,this),this.node.on("touchcancel",this.onTouchEnd,this)},e.setData=function(t){this.setImg(t)},e.reset=function(){this.resetCoolMask(),this.resetCoolState(),this.resetTouchState()},e.startCooling=function(){this.cooled=!1,this.setCoolPrecess(0)},e.setCoolPrecess=function(t){t>1&&(t=1),t<0&&(t=0),this.setCoolRate(t),t>=1&&this.coolFinish()},e.setSkill=function(t){this.setData(t)},e.setBtnId=function(t){this.btnId=t},e.setImg=function(t){var o=this;p.loadBundleRes("LevelUI","Image/"+t,(function(t){o.img.spriteFrame=t,o.coolSprite.spriteFrame=t}),r,!1)},e.initCoolMask=function(){this.coolSprite.fillRange=0},e.resetCoolMask=function(){this.coolSprite.fillRange=0},e.setCoolRate=function(t){this.coolSprite.fillRange=1-t},e.initCoolState=function(){this.cooled=!0},e.resetCoolState=function(){this.cooled=!0,this.setCoolPrecess(1)},e.coolFinish=function(){this.cooled=!0},e.initTouchState=function(){this.touched=!1,this.btnSprite=this.node.getComponent(i),this.btnSprite.color=this.normalColor},e.resetTouchState=function(){this.touched=!1,this.btnSprite.color=this.normalColor},e.onTouchStart=function(){this.cooled&&(this.touched||(this.touched=!0,this.emit(d.Common.CtrlEvent.btnTouchStart,this.btnId),this.btnSprite.color=this.darkColor))},e.onTouchEnd=function(){this.touched&&(this.touched=!1,this.emit(d.Common.CtrlEvent.btnTouchEnd,this.btnId),this.btnSprite.color=this.normalColor)},o}(f)).prototype,"img",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=l(b.prototype,"coolSprite",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=b))||m));o._RF.pop()}}}));

System.register("chunks:///_virtual/LevelController.ts",["cc","./_rollupPluginModLoBabelHelpers.js","./GameEventType.ts","./GlobalEnum.ts","./yyComponent.ts","./SkillBtn.ts"],(function(t){"use strict";var o,e,i,n,s,h,y,r,a,l,c,u,p,v,T,S,j;return{setters:[function(t){o=t.cclegacy,e=t.Node,i=t._decorator,n=t.systemEvent,s=t.SystemEvent,h=t.v2,y=t.UITransform,r=t.macro},function(t){a=t.applyDecoratedDescriptor,l=t.inheritsLoose,c=t.initializerDefineProperty,u=t.assertThisInitialized,p=t.defineProperty},function(t){v=t.EventType},function(t){T=t.GlobalEnum},function(t){S=t.default},function(t){j=t.default}],execute:function(){var k,f,d,C,E,m,P,J;o._RF.push({},"40bcc/o5rtGMK5aKqyYxbY2","LevelController",void 0);var D=i,B=D.ccclass,g=D.property;t("default",(k=g(e),f=g(e),d=g([j]),B((m=a((E=function(t){function o(){for(var o,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return o=t.call.apply(t,[this].concat(i))||this,c(u(o),"joyPanel",m,u(o)),p(u(o),"joyPanelTrans",null),p(u(o),"joyScopeRadius",50),p(u(o),"joyScopeRadiusSqr",2500),p(u(o),"joyCenter",null),p(u(o),"joyDir",null),p(u(o),"joyTouchStartPos",null),p(u(o),"showFlowTouch",!0),c(u(o),"joystick",P,u(o)),c(u(o),"skillBtns",J,u(o)),p(u(o),"keyStay",void 0),p(u(o),"keyMap",{}),o}l(o,t);var i=o.prototype;return i.init=function(){this.initJoy(),this.initKeyMap(),this.initKeyState(),this.initSkillBtns(),this.initCustomUpdateState(),this.registAllCustomUpdate(),this.onEvents()},i.onEvents=function(){this.on(v.Common.CtrlEvent.ctrlStart,this.setEnable,this),this.on(v.Common.CtrlEvent.ctrlEnd,this.setDisable,this),this.on(v.LevelEvent.updatePlayerSkillCool,this.onUpdatePlayerSkillCool,this),this.on(v.Common.CtrlEvent.btnTouchStart,this.onBtnTouchStart,this),this.on(v.Common.CtrlEvent.btnTouchEnd,this.onBtnTouchEnd,this),this.showFlowTouch?(this.node.on(e.EventType.TOUCH_START,this.onJoyTouchStart,this),this.node.on(e.EventType.TOUCH_MOVE,this.onJoyTouchMove,this),this.node.on(e.EventType.TOUCH_END,this.onJoyTouchEnd,this),this.node.on(e.EventType.TOUCH_CANCEL,this.onJoyTouchEnd,this)):(this.joyPanel.on(e.EventType.TOUCH_START,this.onJoyTouchStart,this),this.joyPanel.on(e.EventType.TOUCH_MOVE,this.onJoyTouchMove,this),this.joyPanel.on(e.EventType.TOUCH_END,this.onJoyTouchEnd,this),this.joyPanel.on(e.EventType.TOUCH_CANCEL,this.onJoyTouchEnd,this)),n.on(s.EventType.KEY_DOWN,this.onKeyDown,this),n.on(s.EventType.KEY_UP,this.onKeyUp,this)},i.reset=function(){this.resetJoy(),this.resetKeyState(),this.resetSimpleComps()},i.setEnable=function(){this.reset(),this.node.active=!0,this.setSkillBtnsImg()},i.setDisable=function(){this.reset(),this.node.active=!1},i.initJoy=function(){this.joyDir=h(),this.joyPanelTrans=this.joyPanel.getComponent(y),this.joyScopeRadius=.5*this.joyPanelTrans.width,this.joyScopeRadiusSqr=this.joyScopeRadius*this.joyScopeRadius,this.joyTouchStartPos=h(),this.joyCenter=this.joyPanel.getPosition(),this.joystick.setPosition(this.joyCenter),this.autoHideJoy()},i.resetJoy=function(){this.joyDir.x=0,this.joyDir.y=0,this.joystick.setPosition(this.joyCenter),this.autoHideJoy()},i.showJoy=function(t){this.showFlowTouch&&(this.joyPanel.active=!0,this.joystick.active=!0,t&&(this.joyCenter.x=t.x,this.joyCenter.y=t.y,this.joyPanel.setPosition(this.joyCenter),this.joystick.setPosition(this.joyCenter)))},i.autoHideJoy=function(){this.showFlowTouch&&(this.joyPanel.active=!1,this.joystick.active=!1)},i.onJoyTouchStart=function(t){this.showFlowTouch?(t.getUILocation(this.joyTouchStartPos),this.showJoy(this.joyTouchStartPos),this.joyDir.x=0,this.joyDir.y=0):this.setJoyToTouch(t),this.convertJoyToBtn(),this.emit(v.LevelEvent.startJoy,this.joyDir)},i.onJoyTouchMove=function(t){this.setJoyToTouch(t),this.convertJoyToBtn(),this.emit(v.LevelEvent.moveJoy,this.joyDir)},i.onJoyTouchEnd=function(t){this.resetJoy(),this.convertJoyToBtn();var o=t.getUILocation();this.emit(v.LevelEvent.stopJoy,o)},i.setJoyToTouch=function(t){var o=t.getUILocation();this.joyDir.x=o.x-this.joyCenter.x,this.joyDir.y=o.y-this.joyCenter.y,this.joyDir.lengthSqr()>this.joyScopeRadiusSqr&&(this.joyDir.normalize().multiplyScalar(this.joyScopeRadius),o.x=this.joyCenter.x+this.joyDir.x,o.y=this.joyCenter.y+this.joyDir.y),this.joystick.setPosition(o.x,o.y,0)},i.convertJoyToBtn=function(){},i.initSkillBtns=function(){for(var t=0;t<this.skillBtns.length;++t)this.addSimpleComp(this.skillBtns[t]);this.setSkillBtnsImg()},i.setSkillBtnsImg=function(){},i.getBtnPos=function(){return{}},i.getBtns=function(){return{}},i.initKeyState=function(){this.keyStay=[];for(var t=0;t<T.KeyCode.count;++t)this.keyStay.push(!1)},i.resetKeyState=function(){for(var t=this.keyStay.length-1;t>=0;--t)this.keyStay[t]=!1},i.initKeyMap=function(){var t=r.KEY;this.keyMap[t.w]=T.KeyCode.up,this.keyMap[t.a]=T.KeyCode.left,this.keyMap[t.s]=T.KeyCode.down,this.keyMap[t.d]=T.KeyCode.right},i.onKeyDown=function(t){var o=t.keyCode,e=this.keyStay[this.keyMap[o]];this.keyStay[this.keyMap[o]]=!0,!1===e&&this.emit(v.LevelEvent.keyDown,this.keyMap[o])},i.onKeyUp=function(t){var o=t.keyCode,e=this.keyStay[this.keyMap[o]];this.keyStay[this.keyMap[o]]=!1,e&&this.emit(v.LevelEvent.keyUp,this.keyMap[o])},i.stepKeyStay=function(t){for(var o=this.keyStay.length-1;o>=0;--o)this.keyStay[o]&&this.emit(v.LevelEvent.keyStay,o)},i.update=function(t){this.stepKeyStay(t)},i.onUpdatePlayerSkillCool=function(t){this.skillBtns[1].setCoolPrecess(t[2]),this.skillBtns[2].setCoolPrecess(t[3]),this.skillBtns[3].setCoolPrecess(t[4])},i.onBtnTouchStart=function(t){var o=this.keyStay[t];this.keyStay[t]=!0,!1===o&&this.emit(v.LevelEvent.keyDown,t)},i.onBtnTouchEnd=function(t){var o=this.keyStay[t];this.keyStay[t]=!1,o&&this.emit(v.LevelEvent.keyUp,t)},o}(S)).prototype,"joyPanel",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=a(E.prototype,"joystick",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=a(E.prototype,"skillBtns",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),C=E))||C));o._RF.pop()}}}));

System.register("chunks:///_virtual/LevelInfoUI.ts",["cc","./_rollupPluginModLoBabelHelpers.js","./GameEventType.ts","./GlobalEnum.ts","./Action3dManager.ts","./GlobalData2.ts","./yyComponent.ts","./GlobalPool.ts"],(function(e){"use strict";var i,t,n,o,r,s,l,a,h,c,d,u,p,g,v,f,m,y,P,b,L,T,C;return{setters:[function(e){i=e.cclegacy,t=e.Node,n=e.UITransform,o=e.Label,r=e.Prefab,s=e.Animation,l=e._decorator,a=e.Sprite,h=e.v3,c=e.v2},function(e){d=e.applyDecoratedDescriptor,u=e.inheritsLoose,p=e.defineProperty,g=e.assertThisInitialized,v=e.initializerDefineProperty,f=e.createClass},function(e){m=e.EventType},function(e){y=e.GlobalEnum},function(e){P=e.default,b=e.ActionMngType},function(e){L=e.default},function(e){T=e.default},function(e){C=e.default}],execute:function(){var I,A,E,G,S,D,w,M,x,z,k,B,H,U,R,_,K,N,F,W,O,q,J,j,Q,V,X,Y,Z,$;i._RF.push({},"4393ap5mKNKOIGdbWF8MM3a","LevelInfoUI",void 0);var ee=l,ie=ee.ccclass,te=ee.property;e("default",(I=te(t),A=te(n),E=te(o),G=te(o),S=te(o),D=te(o),w=te(t),M=te(r),x=te(t),z=te(r),k=te(t),B=te(t),H=te(s),U=te(t),ie((K=d((_=function(e){function i(){for(var i,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return i=e.call.apply(e,[this].concat(n))||this,p(g(i),"lv",void 0),v(g(i),"levelProgressBg",K,g(i)),v(g(i),"levelProgress",N,g(i)),p(g(i),"levelProgressTotalLength",349),v(g(i),"curLevel",F,g(i)),v(g(i),"nextLevel",W,g(i)),v(g(i),"remainCount",O,g(i)),p(g(i),"totalEnemyCount",10),v(g(i),"curGoldLabel",q,g(i)),p(g(i),"curGold",0),p(g(i),"_goldTargetPos",void 0),p(g(i),"goldAddElapsed",0),p(g(i),"goldAddDuration",.1),v(g(i),"goldParticleLayer",J,g(i)),v(g(i),"goldParticle",j,g(i)),v(g(i),"dirIconLayer",Q,g(i)),v(g(i),"dirIconPrefab",V,g(i)),p(g(i),"dirIconName",void 0),p(g(i),"dirIconMap",null),p(g(i),"dirElapsed",0),p(g(i),"dirDuration",.01),p(g(i),"dirPtr",0),p(g(i),"dirCachePos",null),p(g(i),"dirScope",null),v(g(i),"killTipLayer",X,g(i)),v(g(i),"handLoop",Y,g(i)),v(g(i),"handAnim",Z,g(i)),v(g(i),"teachTip",$,g(i)),p(g(i),"teachTipAction",null),i}u(i,e);var t=i.prototype;return t.init=function(){this.initCurGold(),this.initDirIcon(),this.initHandAnim(),this.initProgress(),this.initKillTip(),this.initTeachTip(),this.onEvents()},t.onEvents=function(){this.on(m.LevelEvent.resurgence,this.onResurgence,this),this.on(m.LevelEvent.updateRemainEnemy,this.updateRemainEnemy,this),this.on(m.LevelEvent.updateGold,this.updateGold,this),this.on(m.LevelEvent.enemyDead,this.removeDirIcon,this),this.on(m.LevelEvent.playerKillEnemy,this.showKillTip,this),this.on(m.Common.DirectorEvent.playerWin,this.hideGoldBar,this),this.on(m.LevelEvent.showHandAnim,this.showHandAnim,this),this.on(m.LevelEvent.decideWeaponSkin,this.showHandAnim,this),this.on(m.LevelEvent.showHandAnim,this.showProgress,this),this.on(m.LevelEvent.decideWeaponSkin,this.showTeachTip,this),this.once(m.LevelEvent.startJoy,this.hideHandAnim,this)},t.reset=function(){this.resetCurGold(),this.resetDirIcon(),this.resetHandAnim(),this.resetProgress(),this.resetKillTip(),this.resetTeachTip()},t.show=function(e){this.node.active=!0,this.reset(),this.setData(e),this.onEvents(),this.emit(m.Common.DirectorEvent.resumeLevel)},t.hide=function(){this.reset(),this.offEvents(),this.node.active=!1},t.getData=function(){return{lv:this.lv,speGold:0,gold:1}},t.setData=function(e){this.lv=e.lv;var i=L.get(y.myGlobalDataType.matchEnemies);this.totalEnemyCount=i.length,this.remainCount.string=""+this.totalEnemyCount,this.curLevel.string=""+this.lv,this.nextLevel.string=""+(this.lv+1),this.levelProgress.width=1},t.convertToString=function(e){return e<1100?e.toString():e<11e5?(.001*e).toFixed(1)+"K":(1e-6*e).toFixed(1)+"M"},t.initProgress=function(){this.levelProgressTotalLength=this.levelProgress.getComponent(a).spriteFrame.originalSize.width,this.levelProgress.width=this.levelProgressTotalLength,this.levelProgressBg.active=!1},t.resetProgress=function(){this.levelProgressBg.active=!1},t.updateRemainEnemy=function(e){this.remainCount.string=""+e;var i=this.levelProgressTotalLength*(1-e/this.totalEnemyCount);i<1&&(i=1),this.levelProgress.width=i},t.showProgress=function(){this.levelProgressBg.active=!0},t.initCurGold=function(){this.curGold=0,this.curGoldLabel.string=this.curGold.toString(),this.goldAddElapsed=this.goldAddDuration+1},t.resetCurGold=function(){this.curGold=0,this.curGoldLabel.string=this.curGold.toString(),this.goldAddElapsed=this.goldAddDuration+1,this.curGoldLabel.node.parent.active=!0},t.addGold=function(e){void 0===e&&(e=1),this.curGold+=e,this.curGoldLabel.string=this.curGold.toString(),this.goldAddElapsed=0},t.hideGoldBar=function(){this.curGoldLabel.node.parent.active=!1},t.updateGold=function(e){this.curGold=e,this.curGoldLabel.string=this.curGold.toString(),this.goldAddElapsed=0},t.updateGoldLabel=function(e){if(!(this.goldAddElapsed>this.goldAddDuration)){this.goldAddElapsed+=e;var i=1-this.goldAddElapsed/this.goldAddDuration;i<0&&(i=0);var t=1+1*i;this.curGoldLabel.node.setScale(t,t,t)}},t.initGoldParticleLayer=function(){C.createPool(this.goldParticle.name,this.goldParticle)},t.resetGoldParticleLayer=function(){C.putAllChildren(this.goldParticleLayer,!0)},t.addGoldParticle=function(e){var i=C.get(this.goldParticle.name);this.goldParticleLayer.addChild(i);var t=this.node.getComponent(n).convertToNodeSpaceAR(e.p);i.setPosition(t);var o=1;i.setScale(o,o);var r=P.moveTo(1,this.goldTargetPos.x,this.goldTargetPos.y,0);r.easing(P.easeIn(3)),o=.5;var s=P.scaleTo(1,o,o,1);s.easing(P.easeIn(2));var l=P.spawn(r,s),a=P.callFun(this.onGoldParticleAnimFinish,this,{node:i,gold:e.gold}),h=P.sequence(l,a);P.getMng(b.UI).runAction(i,h)},t.onGoldParticleAnimFinish=function(e){this.addGold(e.gold),C.put(e.node)},t.initDirIcon=function(){this.dirIconName=this.dirIconPrefab.data.name,C.createPool(this.dirIconName,this.dirIconPrefab,null),C.preCreate(this.dirIconName,10),this.dirIconMap={},this.dirElapsed=0,this.dirCachePos=h();var e=L.get(y.Common.GlobalDataType.canvasTransform);this.dirScope=c(.5*e.width-20,.5*e.height-20)},t.resetDirIcon=function(){C.putAllChildren(this.dirIconLayer,!0),this.dirIconMap={},this.dirElapsed=0,this.dirPtr=0},t.fillDirIcon=function(e){if(0==this.dirIconLayer.children.length)for(var i=0,t=e.length;i<t;++i){var n=C.get(this.dirIconName);n.setPosition(-9999,-9999,0),this.dirIconLayer.addChild(n),this.dirIconMap[e[i].Id]=n}},t.removeDirIcon=function(e){var i=e.Id;this.dirIconMap[i]&&(C.put(this.dirIconMap[i]),delete this.dirIconMap[i])},t.updateDirIcon=function(e){var i=L.get(y.myGlobalDataType.enemies);if(i&&0!=i.length){this.fillDirIcon(i);for(var t=i.length-1;t>=0;--t)this.updateOneDirIcon(i[t])}else this.resetDirIcon()},t.updateOneDirIcon=function(e){this.dirCachePos.set(e.node.position),L.get(y.Common.GlobalDataType.levelCamera).camera.convertToUINode(this.dirCachePos,this.dirIconLayer,this.dirCachePos);var i=!1;this.dirCachePos.x<-this.dirScope.x?(this.dirCachePos.y*=-this.dirScope.x/this.dirCachePos.x,this.dirCachePos.x=-this.dirScope.x,i=!0):this.dirCachePos.x>this.dirScope.x&&(this.dirCachePos.y*=this.dirScope.x/this.dirCachePos.x,this.dirCachePos.x=this.dirScope.x,i=!0),this.dirCachePos.y<-this.dirScope.y?(this.dirCachePos.x*=-this.dirScope.y/this.dirCachePos.y,this.dirCachePos.y=-this.dirScope.y,i=!0):this.dirCachePos.y>this.dirScope.y&&(this.dirCachePos.x*=this.dirScope.y/this.dirCachePos.y,this.dirCachePos.y=this.dirScope.y,i=!0);var t=this.dirIconMap[e.Id];if(t.active=i,i){t.setPosition(this.dirCachePos);var n=Math.atan2(this.dirCachePos.y,this.dirCachePos.x)+1.57;n*=.5,t.setRotation(0,0,Math.sin(n),Math.cos(n))}},t.initKillTip=function(){for(var e=this.killTipLayer.children.length-1;e>=0;--e)this.killTipLayer.children[e].setScale(0,0,0)},t.resetKillTip=function(){for(var e=P.getMng(b.UI),i=this.killTipLayer.children.length-1;i>=0;--i)e.stopAllActions(this.killTipLayer.children[i]),this.killTipLayer.children[i].setScale(0,0,0)},t.showKillTip=function(){for(var e=this.killTipLayer.children,i=Math.floor(Math.random()*e.length-.001),t=e.length-1;t>=0;--t)e[t].scale.x>0&&i++;i>=e.length&&(i%=e.length);var n=.3,o=e[i];o.setScale(n,n,n);n=.7;var r=P.scaleTo(1,n,n,n);r.easing(P.easeElasticOut(.3)),n=0;var s=P.scaleTo(0,n,n,n),l=P.sequence(r,s);P.getMng(b.UI).runAction(o,l)},t.initHandAnim=function(){this.hideHandAnim()},t.resetHandAnim=function(){this.hideHandAnim()},t.showHandAnim=function(){this.once(m.LevelEvent.startJoy,this.hideHandAnim,this),this.handLoop.active=!0,this.handAnim.play()},t.hideHandAnim=function(){this.handAnim.stop(),this.handLoop.active=!1},t.initTeachTip=function(){this.teachTip.active=!1;var e=P.fadeTo(0,255),i=P.delay(8),t=P.fadeTo(1,0);this.teachTipAction=P.sequence(e,i,t)},t.resetTeachTip=function(){P.getMng(b.Level).stopAllActions(this.teachTip),this.teachTip.active=!1},t.showTeachTip=function(){this.teachTip.active=!0,P.getMng(b.Level).runAction(this.teachTip,this.teachTipAction)},t.onBtnConfigSetting=function(){this.emit(m.Common.AudioEvent.playClickBtn),this.emit(m.Common.UIEvent.enter,y.UI.configSetting)},t.onBtnPause=function(){this.emit(m.Common.AudioEvent.playClickBtn),this.emit(m.Common.UIEvent.enter,y.UI.pauseLevel)},t.onBtnLobby=function(){this.emit(m.Common.DirectorEvent.enterLobby)},t.onBtnWin=function(){this.emit(m.LevelEvent.testWin)},t.onBtnLose=function(){this.emit(m.LevelEvent.testLose)},t.onResurgence=function(){},t.update=function(e){this.updateGoldLabel(e),this.updateDirIcon(e)},f(i,[{key:"uiType",get:function(){return y.UI.levelInfo}},{key:"goldTargetPos",get:function(){return this._goldTargetPos||(this._goldTargetPos=this.curGoldLabel.getComponent(n).convertToWorldSpaceAR(h()),this.node.getComponent(n).convertToNodeSpaceAR(this._goldTargetPos,this._goldTargetPos)),this._goldTargetPos}}]),i}(T)).prototype,"levelProgressBg",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=d(_.prototype,"levelProgress",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=d(_.prototype,"curLevel",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=d(_.prototype,"nextLevel",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=d(_.prototype,"remainCount",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=d(_.prototype,"curGoldLabel",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=d(_.prototype,"goldParticleLayer",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=d(_.prototype,"goldParticle",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=d(_.prototype,"dirIconLayer",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=d(_.prototype,"dirIconPrefab",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=d(_.prototype,"killTipLayer",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=d(_.prototype,"handLoop",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=d(_.prototype,"handAnim",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=d(_.prototype,"teachTip",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=_))||R));i._RF.pop()}}}));

System.register("chunks:///_virtual/AwardItem.ts",["cc","./_rollupPluginModLoBabelHelpers.js"],(function(t){"use strict";var e,i,r,n,o,a,s,l,u,c;return{setters:[function(t){e=t.cclegacy,i=t._decorator,r=t.Sprite,n=t.Label,o=t.SpriteFrame,a=t.Component},function(t){s=t.applyDecoratedDescriptor,l=t.inheritsLoose,u=t.initializerDefineProperty,c=t.assertThisInitialized}],execute:function(){var p,d,f,g,h,m,y,b,v;e._RF.push({},"513efrqYFxC3YrmuihTsW4Y","AwardItem",void 0);var w=i.ccclass,D=i.property;t("AwardItem",(p=w("AwardItem"),d=D(r),f=D(n),g=D([o]),p((y=s((m=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return e=t.call.apply(t,[this].concat(r))||this,u(c(e),"spr",y,c(e)),u(c(e),"gold",b,c(e)),u(c(e),"imgs",v,c(e)),e}l(e,t);var i=e.prototype;return i.init=function(t){t&&this.setData(t)},i.reuse=function(t){t&&this.setData(t)},i.setData=function(t){"gold"==t.goodsType?(this.spr.spriteFrame=this.imgs[0],this.gold.node.active=!0,this.gold.string=t.value):(this.gold.node.active=!1,this.spr.spriteFrame=this.imgs[t.id-5])},i.unuse=function(){},e}(a)).prototype,"spr",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=s(m.prototype,"gold",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=s(m.prototype,"imgs",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),h=m))||h));e._RF.pop()}}}));

System.register("chunks:///_virtual/LoseUI.ts",["cc","./_rollupPluginModLoBabelHelpers.js","./GameEventType.ts","./GlobalEnum.ts","./yyComponent.ts"],(function(e){"use strict";var t,n,i,o,s,r,a,c,u,m,h,l,p;return{setters:[function(e){t=e.cclegacy,n=e.Node,i=e.Sprite,o=e._decorator},function(e){s=e.applyDecoratedDescriptor,r=e.inheritsLoose,a=e.initializerDefineProperty,c=e.assertThisInitialized,u=e.defineProperty,m=e.createClass},function(e){h=e.EventType},function(e){l=e.GlobalEnum},function(e){p=e.default}],execute:function(){var f,d,v,y,b,T;t._RF.push({},"6f8173lok9Jd7axmbmpArAu","LoseUI",void 0);var w=o,E=w.ccclass,g=w.property;e("default",(f=g(n),d=g(i),E((b=s((y=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i))||this,a(c(t),"btnVideo",b,c(t)),a(c(t),"barSpr",T,c(t)),u(c(t),"nowTime",0),u(c(t),"showTime",5),t}r(t,e);var i=t.prototype;return i.init=function(e){void 0!==e&&this.setData(e)},i.setData=function(e){this.btnVideo.active=e.canResurgence,e.canResurgence&&(this.nowTime=0,this.barSpr.fillRange=1-this.nowTime/this.showTime)},i.onEvents=function(){this.node.on(n.EventType.TOUCH_END,this.onNodeTouchEnd,this),this.on(h.LevelEvent.stopJoy,this.onStopJoy,this)},i.reset=function(){},i.show=function(e){this.reset(),this.node.active=!0,void 0!==e&&void 0!==e.data&&this.setData(e.data),this.onEvents()},i.update=function(e){this.btnVideo.active&&this.nowTime<=this.showTime&&(this.nowTime+=e,this.barSpr.fillRange=1-this.nowTime/this.showTime,this.nowTime>=this.showTime&&(this.btnVideo.active=!1))},i.onContinueGame=function(){this.emit(h.Common.AudioEvent.playClickBtn),this.enterLobby()},i.onBtnResurgence=function(){this.emit(h.Common.AudioEvent.playClickBtn),this.resurgenceByVideo()},i.resurgenceByVideo=function(){var e=this;this.emit(h.Common.SDKEvent.showVideo,{success:function(){e.emit(h.Common.UIEvent.exit,e.uiType),e.emit(h.LevelEvent.resurgence)}})},i.enterLobby=function(){this.emit(h.Common.PlayerDataEvent.trySkinEnd),this.emit(h.Common.UIEvent.exit,this.uiType),this.emit(h.Common.GameFlow.enterGameFlow,l.Common.GameFlowStep.recommendDialog)},i.onBtnMoreGame=function(){this.emit(h.Common.SDKEvent.showAppBox)},i.onBtnShare=function(){this.emit(h.Common.SDKEvent.shareToFriends)},i.onStopJoy=function(e){e.y<320&&this.emit(h.Common.HeyGameSDK.clickNativeAd)},i.onNodeTouchEnd=function(e){var t=e.getUILocation();this.onStopJoy(t)},m(t,[{key:"uiType",get:function(){return l.UI.loseUI}}]),t}(p)).prototype,"btnVideo",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=s(y.prototype,"barSpr",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=y))||v));t._RF.pop()}}}));

System.register("chunks:///_virtual/Item.ts",["cc","./_rollupPluginModLoBabelHelpers.js","./GameEventType.ts","./GlobalEnum.ts","./yyComponent.ts","./PlayerData.ts","./Loader.ts"],(function(t){"use strict";var e,o,i,n,s,a,r,d,u,g,l,h,p,f,c,y;return{setters:[function(t){e=t.cclegacy,o=t._decorator,i=t.Sprite,n=t.Label,s=t.Node,a=t.SpriteFrame},function(t){r=t.applyDecoratedDescriptor,d=t.inheritsLoose,u=t.defineProperty,g=t.assertThisInitialized,l=t.initializerDefineProperty},function(t){h=t.EventType},function(t){p=t.GlobalEnum},function(t){f=t.default},function(t){c=t.default},function(t){y=t.default}],execute:function(){var m,I,v,b,S,T,k,B,w,D,U,P,C,G,E,L,z,V,W,F,H,_,x;e._RF.push({},"91244zyQP1OTYGx5MilSb+u","Item",void 0);var O=o.ccclass,M=o.property;t("Item",(m=O("Item"),I=M(i),v=M(n),b=M(n),S=M(s),T=M(s),k=M(s),B=M(a),w=M(a),D=M(a),U=M(i),m((G=r((C=function(t){function e(){for(var e,o=arguments.length,i=new Array(o),n=0;n<o;n++)i[n]=arguments[n];return e=t.call.apply(t,[this].concat(i))||this,u(g(e),"goodsInfo",null),u(g(e),"goodsUseType",null),l(g(e),"goodsImg",G,g(e)),l(g(e),"goldLabel",E,g(e)),l(g(e),"videoLabel",L,g(e)),l(g(e),"btnBuy",z,g(e)),l(g(e),"btnVideo",V,g(e)),l(g(e),"btnState",W,g(e)),l(g(e),"stateImg",F,g(e)),l(g(e),"onBgImg",H,g(e)),l(g(e),"offBgImg",_,g(e)),l(g(e),"bgSpr",x,g(e)),e}d(e,t);var o=e.prototype;return o.init=function(t){t&&this.setData(t),this.node.on(s.EventType.TOUCH_END,this.onClickItem,this)},o.reuse=function(t){t&&this.setData(t)},o.setData=function(t){t?(this.goodsInfo=t,this.loadImage(t.goodsType+t.id,this.setImage)):console.log("数据不存在")},o.unuse=function(){},o.loadImage=function(t,e){var o=this;y.loadBundle("UI",(function(){y.loadBundleRes("UI","Image/shop/skin/"+t+"/spriteFrame",(function(t){e&&e.call(o,t)}))}),!1,!1)},o.setImage=function(t){t&&(this.goodsImg.spriteFrame=t),this.setInfo()},o.setInfo=function(){this.setGoldNum();var t=c.getData("gameData"),e=this.goodsInfo.goodsType;if(e==p.GoodsType.skin){var o=t.PlayerSkin.videoCount[String(this.goodsInfo.id)];o||(o=0),t.PlayerSkin.owned.indexOf(this.goodsInfo.id)>=0?(this.goodsUseType="owned",t.PlayerSkin.cur==this.goodsInfo.id&&(this.goodsUseType="using")):this.goodsUseType="none"}else if(e==p.GoodsType.hat){var i=t.HatSkin.videoCount[String(this.goodsInfo.id)];i||(i=0),t.HatSkin.owned.indexOf(this.goodsInfo.id)>=0?(this.goodsUseType="owned",t.HatSkin.cur==this.goodsInfo.id&&(this.goodsUseType="using")):this.goodsUseType="none"}else{var n=t.WeaponSkin.videoCount[this.goodsInfo.goodsType][String(this.goodsInfo.id)];n||(n=0),t.WeaponSkin.owned[this.goodsInfo.goodsType].indexOf(this.goodsInfo.id)>=0?(this.goodsUseType="owned",t.WeaponSkin.cur.type==this.goodsInfo.goodsType&&t.WeaponSkin.cur.id==this.goodsInfo.id&&(this.goodsUseType="using")):this.goodsUseType="none"}this.updateBtn(this.goodsUseType)},o.setUseType=function(){var t="gameData",e=".cur",o=".cur",i=this.goodsInfo.goodsType;if(i==p.GoodsType.skin?t+=".PlayerSkin":i==p.GoodsType.hat?t+=".HatSkin":(t+=".WeaponSkin",e+=".id",o+=".type"),c.getData(t+e)==this.goodsInfo.id){var n=c.getData(t+o);if(!n||n==this.goodsInfo.goodsType)return void(this.goodsUseType="using")}},o.setGoldNum=function(){this.goldLabel.string=this.goodsInfo.costValue},o.updateBtn=function(t){"owned"==t?(this.btnBuy.active=!1,this.btnVideo.active=!1,this.btnState.active=!0,this.setBtnState("owned"),this.unuseBg()):"using"==t?(this.btnBuy.active=!1,this.btnVideo.active=!1,this.btnState.active=!0,this.setBtnState("using"),this.useBg()):"none"==t&&("spin"==this.goodsInfo.costType?(this.btnBuy.active=!1,this.btnVideo.active=!1,this.btnState.active=!0,this.setBtnState("none")):(this.btnBuy.active=!0,this.btnVideo.active=!0,this.btnState.active=!1),this.unuseBg())},o.setBtnState=function(t){"owned"==t?this.btnState.getComponent(i).spriteFrame=this.stateImg[0]:"using"==t?this.btnState.getComponent(i).spriteFrame=this.stateImg[1]:"none"==t&&(this.btnState.getComponent(i).spriteFrame=this.stateImg[2])},o.onBtnBuy=function(){this.playClickBtn();var t=c.getData("gameData.asset.gold"),e=this.goodsInfo.costValue;e>t?(this.showMsg("金币不够~"),this.showUI(p.UI.getGoldByVideo)):(c.subGold(e),this.getGoods(),this.setInfo())},o.onBtnVideo=function(){var t=this;this.playClickBtn(),this.emit(h.Common.SDKEvent.showVideo,{success:function(){var e="gameData.",o=t.goodsInfo.goodsType;e+="skin"==o?"PlayerSkin.videoCount."+t.goodsInfo.id:"hat"==o?"HatSkin.videoCount."+t.goodsInfo.id:"WeaponSkin.videoCount."+t.goodsInfo.goodsType+"."+t.goodsInfo.id,t.emit(h.Common.PlayerDataEvent.updatePlayerData,{attribute:e,value:1,mode:"+",emit:!0,save:!0}),c.getData(e)>=t.goodsInfo.videoValue&&t.getGoods(),t.setInfo()},fail:function(){t.showMsg("广告拉取失败，请稍后再试~")}})},o.onBtnState=function(){this.playClickBtn(),"owned"==this.goodsUseType?(this.useGoods(),this.setInfo(),this.emit(h.LevelEvent.goodsUSE)):"using"==this.goodsUseType?(this.unuseGoods(),this.setInfo(),this.emit(h.LevelEvent.goodsUSE)):"none"==this.goodsUseType&&(this.hideUI(p.UI.shop),this.showUI(p.UI.spin),this.emit(h.LevelEvent.changeGoldPos,!1))},o.getGoods=function(){var t="gameData.",e=this.goodsInfo.goodsType;t+="skin"==e?"PlayerSkin.owned":"hat"==e?"HatSkin.owned":"WeaponSkin.owned."+this.goodsInfo.goodsType,this.emit(h.Common.PlayerDataEvent.updatePlayerData,{attribute:t,value:this.goodsInfo.id,mode:"push",emit:!0,save:!0})},o.useGoods=function(){var t="gameData.",e=this.goodsInfo.goodsType,o={};"skin"==e?(t+="PlayerSkin.cur",o=this.goodsInfo.id):"hat"==e?(t+="HatSkin.cur",o=this.goodsInfo.id):(t+="WeaponSkin.cur",o={id:this.goodsInfo.id,type:this.goodsInfo.goodsType}),this.emit(h.Common.PlayerDataEvent.updatePlayerData,{attribute:t,value:o,mode:"=",emit:!0,save:!0}),this.preview()},o.unuseGoods=function(){var t="gameData.",e=this.goodsInfo.goodsType,o={};"skin"==e?(t+="PlayerSkin.cur",o=0):"hat"==e?(t+="HatSkin.cur",o=0):(t+="WeaponSkin.cur",o={id:1,type:p.WeaponType.katana}),this.emit(h.Common.PlayerDataEvent.updatePlayerData,{attribute:t,value:o,mode:"=",emit:!0,save:!0}),this.emit(h.LevelEvent.setPreview,{type:e,data:{id:0,type:p.WeaponType.none}})},o.preview=function(){this.emit(h.LevelEvent.setPreview,{type:this.goodsInfo.goodsType,data:{id:this.goodsInfo.id,type:this.goodsInfo.goodsType}})},o.useBg=function(){this.bgSpr.spriteFrame=this.onBgImg},o.unuseBg=function(){this.bgSpr.spriteFrame=this.offBgImg},o.refresh=function(){this.setInfo()},o.onClickItem=function(){this.playClickBtn(),this.preview()},e}(f)).prototype,"goodsImg",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=r(C.prototype,"goldLabel",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=r(C.prototype,"videoLabel",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=r(C.prototype,"btnBuy",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=r(C.prototype,"btnVideo",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=r(C.prototype,"btnState",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=r(C.prototype,"stateImg",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),H=r(C.prototype,"onBgImg",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=r(C.prototype,"offBgImg",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=r(C.prototype,"bgSpr",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=C))||P));e._RF.pop()}}}));

System.register("chunks:///_virtual/SpinUI.ts",["cc","./_rollupPluginModLoBabelHelpers.js","./GameEventType.ts","./GlobalEnum.ts","./Action3dManager.ts","./GlobalData2.ts","./yyComponent.ts","./PlayerData.ts","./GlobalPool.ts"],(function(t){"use strict";var e,i,a,n,r,o,s,l,d,u,p,h,m,c,g,f,b,v,y,w,S,D,C,A,T,z;return{setters:[function(t){e=t.cclegacy,i=t._decorator,a=t.Label,n=t.Prefab,r=t.Node,o=t.Sprite,s=t.SpriteFrame,l=t.Button,d=t.UIOpacity,u=t.UITransform,p=t.v3},function(t){h=t.applyDecoratedDescriptor,m=t.inheritsLoose,c=t.defineProperty,g=t.assertThisInitialized,f=t.initializerDefineProperty,b=t.createClass},function(t){v=t.EventType},function(t){y=t.GlobalEnum},function(t){w=t.default,S=t.ActionMngType},function(t){D=t.default},function(t){C=t.default},function(t){A=t.default},function(t){T=t.default,z=t.customPoolScript}],execute:function(){var P,I,F,E,B,k,N,G,M,L,U,x,R,H,_,O,V,j,q,J,K,Q,W,X,Y,Z,$;e._RF.push({},"91c24lUrNJH8rcVQEALlTpe","SpinUI",void 0);var tt=i.ccclass,et=i.property;t("SpinUI",(P=tt("SpinUI"),I=et(a),F=et(n),E=et(r),B=et(r),k=et(a),N=et([o]),G=et(s),M=et(r),L=et(o),U=et(l),x=et(l),R=et([s]),P((O=h((_=function(t){function e(){for(var e,i=arguments.length,a=new Array(i),n=0;n<i;n++)a[n]=arguments[n];return e=t.call.apply(t,[this].concat(a))||this,c(g(e),"stepTime",0),f(g(e),"timeLab",O,g(e)),c(g(e),"isFree",!1),f(g(e),"awardItem",V,g(e)),c(g(e),"awardItems",[]),f(g(e),"dialNode",j,g(e)),c(g(e),"countAward",{tip:[3,5,20],3:{id:5,goodsType:"hat"},8:{id:16,goodsType:"skin"},20:{id:18,goodsType:"skin"}}),c(g(e),"spinAward",[{id:6,goodsType:"hat"},{id:7,goodsType:"hat"},{id:8,goodsType:"hat"}]),c(g(e),"prizes",[]),c(g(e),"spinCount",0),f(g(e),"bar",q,g(e)),f(g(e),"countLabel",J,g(e)),f(g(e),"img",K,g(e)),f(g(e),"getedImg",Q,g(e)),c(g(e),"mng",null),f(g(e),"awardNode",W,g(e)),f(g(e),"awardSpr",X,g(e)),c(g(e),"delay",null),f(g(e),"btnSpin",Y,g(e)),f(g(e),"btnBack",Z,g(e)),f(g(e),"btnSprs",$,g(e)),e}m(e,t);var i=e.prototype;return i.init=function(t){void 0!==t&&this.setData(t),this.initAwardTable()},i.setData=function(t){},i.reset=function(){},i.show=function(t){this.reset(),this.node.active=!0,void 0!==t&&void 0!==t.data&&this.setData(t.data),this.resetDial(),this.awardNode.active=!1,this.emit(v.LevelEvent.changeGoldPos,!1)},i.update=function(t){this.stepTime+=t,this.stepTime>=30&&(this.stepTime=0,this.stepMinute()),this.mng&&this.mng.update(t)},i.stepMinute=function(){this.updateBtnFreeSpin()},i.updateBtnFreeSpin=function(){var t=A.getData("gameData.lastFreeTime"),e=420-((new Date).getTime()-t)/1e3/60;if(e<=0)this.timeLab.node.active=!1,this.btnSpin.node.getComponent(o).spriteFrame=this.btnSprs[0],this.isFree=!0;else{var i=Math.floor(e/60),a=Math.floor(e%60);this.timeLab.node.active=!0,this.timeLab.string=i.toString()+"小时"+a.toString()+"分后免费",this.btnSpin.node.getComponent(o).spriteFrame=this.btnSprs[1],this.isFree=!1}this.btnSpin.node.getComponent(d).opacity=255,this.btnSpin.interactable=!0},i.initAwardTable=function(){T.createPool(this.awardItem.data.name,this.awardItem,this.awardItem.data.name);for(var t=0;t<8;t++){var e=T.get(this.awardItem.data.name);this.dialNode.addChild(e),e.angle=-45*t,this.awardItems.push(e[z])}},i.fillPrize=function(){this.findSpinGoods(),this.setCountAward(),this.setSpinAward()},i.findSpinGoods=function(){this.prizes=[];for(var t=A.getData("gameData.HatSkin.owned"),e=0;e<this.spinAward.length;e++){t.indexOf(this.spinAward[e].id)<0&&this.prizes.push(this.spinAward[e])}this.spinCount=A.getData("gameData.spinCount")},i.setCountAward=function(){var t=this.bar.getComponent(o).spriteFrame.originalSize.width,e=this.spinCount/20;e>1&&(e=1),this.bar.getComponent(u).width=t*e,this.countLabel.string=this.spinCount.toString(),this.spinCount>=3&&(this.img[0].spriteFrame=this.getedImg,this.spinCount>=8&&(this.img[1].spriteFrame=this.getedImg,this.spinCount>=20&&(this.img[2].spriteFrame=this.getedImg)))},i.setSpinAward=function(){for(;8!=this.prizes.length;)this.prizes.length>8?this.prizes.pop():this.prizes.push({value:this.getRandomGold(),goodsType:"gold"});this.prizes=this.randomArry(this.prizes);for(var t=0;t<this.prizes.length;t++){var e=this.prizes[t];this.awardItems[t].setData(e)}},i.getRandomGold=function(){return 100*(Math.floor(9*Math.random())+2)},i.randomArry=function(t){for(var e=t.length,i=[],a=0;a<e;a++)i.push(a);for(var n=[],r=0;r<8;r++){var o=Math.floor(Math.random()*i.length),s=i.splice(o,1)[0];n.push(t[s])}return n},i.resetDial=function(){this.dialNode.angle=0,this.mng||(this.mng=w.getMng(S.UI)),this.mng.stopAllActions(this.dialNode),this.fillPrize(),this.resetBtn()},i.rotateDial=function(){this.unableBtn();var t=this.getRandomAngle(),e=w.rotateTo2d(6,360*t);e.easing(w.easeInOut(2));var i=w.callFun(this.getAward,this,t),a=w.sequence(e,i);this.mng.runAction(this.dialNode,a),this.emit(v.Common.AudioEvent.playEffect,y.AudioClip.spin)},i.getAward=function(t){var e=Math.floor(8*(t-Math.floor(t))),i=this.prizes[e];this.addSpinCount();var a=A.getData("gameData.spinCount");3==a||8==a||20==a?(3==a?(this.awardNode.active=!0,this.awardSpr.spriteFrame=this.img[0].node.children[0].getComponent(o).spriteFrame,this.emit(v.Common.PlayerDataEvent.updatePlayerData,{attribute:"gameData.HatSkin.owned",value:5,mode:"push",emit:!0,save:!0})):8==a?(this.awardNode.active=!0,this.awardSpr.spriteFrame=this.img[1].node.children[0].getComponent(o).spriteFrame,this.emit(v.Common.PlayerDataEvent.updatePlayerData,{attribute:"gameData.PlayerSkin.owned",value:16,mode:"push",emit:!0,save:!0})):20==a&&(this.awardNode.active=!0,this.awardSpr.spriteFrame=this.img[2].node.children[0].getComponent(o).spriteFrame,this.emit(v.Common.PlayerDataEvent.updatePlayerData,{attribute:"gameData.PlayerSkin.owned",value:18,mode:"push",emit:!0,save:!0})),this.delay={award:i,index:e}):(this.addAward(i,e),this.delay=null)},i.addAward=function(t,e){var i=this;"gold"==t.goodsType?this.addGold(t.value,e,(function(){i.resetDial(),i.resetBtn()})):"hat"==t.goodsType&&(this.emit(v.Common.AudioEvent.playEffect,y.AudioClip.getSkin),this.awardNode.active=!0,this.awardSpr.spriteFrame=this.awardItems[e].spr.spriteFrame,this.emit(v.Common.PlayerDataEvent.updatePlayerData,{attribute:"gameData.HatSkin.owned",value:t.id,mode:"push",emit:!0,save:!0}))},i.addGold=function(t,e,i){var a=this,n=this.awardItems[e].node.getComponent(u).convertToWorldSpaceAR(p(0,0,0)),r=D.get(y.Common.GlobalDataType.canvasTransform);n.x-=.5*r.width,n.y-=.5*r.height,this.emit(v.Common.UIEvent.playGoldAnim,{startPos:n,cb:function(){a.emit(v.Common.PlayerDataEvent.updatePlayerData,{attribute:"gameData.asset.gold",value:t,mode:"+",emit:!0,save:!0}),i&&i()},gold:t})},i.getRandomAngle=function(){return 5+5*Math.random()},i.addSpinCount=function(){this.emit(v.Common.PlayerDataEvent.updatePlayerData,{attribute:"gameData.spinCount",value:1,mode:"+",emit:!0,save:!0})},i.resetBtn=function(){this.btnBack.interactable=!0,this.updateBtnFreeSpin()},i.unableBtn=function(){this.btnSpin.interactable=!1,this.btnSpin.node.getComponent(d).opacity=100,this.btnBack.interactable=!1},i.onBtnSpin=function(){this.playClickBtn(),this.isFree?this.freeSpin():this.videoSpin()},i.freeSpin=function(){var t=(new Date).getTime();this.emit(v.Common.PlayerDataEvent.updatePlayerData,{attribute:"gameData.lastFreeTime",value:t,mode:"=",emit:!0,save:!0}),this.rotateDial()},i.videoSpin=function(){var t=this;this.emit(v.Common.SDKEvent.showVideo,{success:function(){t.rotateDial()}})},i.onBtnExitAward=function(){if(this.playClickBtn(),this.awardNode.active=!1,this.delay)return this.addAward(this.delay.award,this.delay.index),void(this.delay=null);this.resetDial(),this.resetBtn()},i.onBtnExit=function(){this.playClickBtn(),this.emit(v.Common.UIEvent.exit,this.uiType),this.emit(v.LevelEvent.changeGoldPos,!0)},b(e,[{key:"uiType",get:function(){return y.UI.spin}}]),e}(C)).prototype,"timeLab",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=h(_.prototype,"awardItem",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=h(_.prototype,"dialNode",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=h(_.prototype,"bar",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=h(_.prototype,"countLabel",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=h(_.prototype,"img",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Q=h(_.prototype,"getedImg",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=h(_.prototype,"awardNode",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=h(_.prototype,"awardSpr",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=h(_.prototype,"btnSpin",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=h(_.prototype,"btnBack",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=h(_.prototype,"btnSprs",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),H=_))||H));e._RF.pop()}}}));

System.register("chunks:///_virtual/LoopListH.ts",["cc","./_rollupPluginModLoBabelHelpers.js","./yyComponent.ts","./GlobalPool.ts"],(function(t){"use strict";var e,i,a,s,r,o,n,c,l,h,u;return{setters:[function(t){e=t.cclegacy,i=t._decorator,a=t.Prefab,s=t.Node},function(t){r=t.applyDecoratedDescriptor,o=t.inheritsLoose,n=t.initializerDefineProperty,c=t.assertThisInitialized,l=t.defineProperty},function(t){h=t.default},function(t){u=t.default}],execute:function(){var p,f,m,d,v,L,y;e._RF.push({},"ac8f0+OvrhAi6Tk05I+7btH","LoopListH",void 0);var X=i.ccclass,b=i.property;t("LoopListH",(p=X("LoopListH"),f=b(a),m=b(s),p((L=r((v=function(t){function e(){for(var e,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return e=t.call.apply(t,[this].concat(a))||this,n(c(e),"itemPrefab",L,c(e)),n(c(e),"itemLayer",y,c(e)),l(c(e),"items",[]),l(c(e),"data",[]),l(c(e),"curPtr",0),l(c(e),"minX",void 0),l(c(e),"maxX",void 0),l(c(e),"spaceX",void 0),e}o(e,t);var i=e.prototype;return i.init=function(t){u.createPool(this.itemPrefab.data.name,this.itemPrefab,"LoopListItem"),t&&this.setData(t)},i.setData=function(t){this.setScope(t);for(var e=0,i=t.data.length;e<i;++e)this.addItem(t.data[e])},i.addItem=function(t){var e=u.get("LoopListItem",t);e.setPosition(this.minX+this.itemLayer.children.length*this.spaceX,0),this.items.push(e),this.itemLayer.addChild(e)},i.setScope=function(t){this.spaceX=t.spaceX;var e=t.data.length*this.spaceX;this.minX=-.5*e,this.maxX=.5*e},i.setOffset=function(t){for(var e=0,i=this.items.length;e<i;++e){var a=this.minX+e*this.spaceX;a+=t;var s=this.maxX-a;a=s=this.maxX-s%(2*this.maxX),this.items[e].setPosition(a,0,0);var r=1-Math.abs(a)/this.maxX;this.items[e].setScale(r,r,r)}},e}(h)).prototype,"itemPrefab",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=r(v.prototype,"itemLayer",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=v))||d));e._RF.pop()}}}));

System.register("chunks:///_virtual/LoopListItem.ts",["cc","./_rollupPluginModLoBabelHelpers.js","./yyComponent.ts","./Loader.ts"],(function(t){"use strict";var e,i,r,n,o,s,a,c,u;return{setters:[function(t){e=t.cclegacy,i=t._decorator,r=t.Sprite},function(t){n=t.applyDecoratedDescriptor,o=t.inheritsLoose,s=t.initializerDefineProperty,a=t.assertThisInitialized},function(t){c=t.default},function(t){u=t.default}],execute:function(){var p,l,f,m,d;e._RF.push({},"aee6dAfTU5EULHNjvkexdBv","LoopListItem",void 0);var L=i.ccclass,g=i.property;t("LoopListItem",(p=L("LoopListItem"),l=g(r),p((d=n((m=function(t){function e(){for(var e,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return e=t.call.apply(t,[this].concat(r))||this,s(a(e),"img",d,a(e)),e}o(e,t);var i=e.prototype;return i.setData=function(t){this.setImg(t)},i.setImg=function(t){var e=this;u.loadBundleRes("UI","mapImg/"+t+"/spriteFrame",(function(t){e.img.spriteFrame=t}))},e}(c)).prototype,"img",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=m))||f));e._RF.pop()}}}));

System.register("chunks:///_virtual/ShopUI.ts",["cc","./_rollupPluginModLoBabelHelpers.js","./GameEventType.ts","./GlobalEnum.ts","./yyComponent.ts","./Loader.ts","./GlobalPool.ts","./GameData.ts"],(function(t){"use strict";var e,i,n,a,o,s,r,h,l,u,d,c,p,f,m,g,y,v,w,C,b;return{setters:[function(t){e=t.cclegacy,i=t._decorator,n=t.Prefab,a=t.Node,o=t.PageView,s=t.Sprite,r=t.SpriteFrame,h=t.instantiate},function(t){l=t.applyDecoratedDescriptor,u=t.inheritsLoose,d=t.initializerDefineProperty,c=t.assertThisInitialized,p=t.defineProperty,f=t.createClass},function(t){m=t.EventType},function(t){g=t.GlobalEnum},function(t){y=t.default},function(t){v=t.default},function(t){w=t.default,C=t.customPoolScript},function(t){b=t.default}],execute:function(){var I,L,S,G,D,k,B,N,E,P,R,T,z,U,M,A,F;e._RF.push({},"aef7eKjzyJFzIohdpa+CLhG","ShopUI",void 0);var _,x=i.ccclass,j=i.property;!function(t){t[t.skin=0]="skin",t[t.hat=1]="hat",t[t.weapon=2]="weapon"}(_||(_={}));t("ShopUI",(I=x("ShopUI"),L=j(n),S=j([a]),G=j(o),D=j([s]),k=j(r),B=j(r),N=j(a),I((R=l((P=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,d(c(e),"item",R,c(e)),p(c(e),"GoodsData",void 0),p(c(e),"nowCard",g.GoodsType.skin),d(c(e),"cards",T,c(e)),p(c(e),"items",[]),d(c(e),"pageManage",z,c(e)),p(c(e),"weaponList",["katana","captain","claw","gun","hunter","knife","trapper"]),p(c(e),"goalNum",0),p(c(e),"nowNum",0),d(c(e),"btnSprs",U,c(e)),d(c(e),"defaultImg",M,c(e)),d(c(e),"chioseImg",A,c(e)),d(c(e),"roleLayer",F,c(e)),e}u(e,t);var i=e.prototype;return i.init=function(t){this.initRoleLayer(),void 0!==t&&this.setData(t),this.loadData(),this.onEvents(),w.createPool(this.item.data.name,this.item,this.item.data.name)},i.setData=function(t){},i.reset=function(){this.resetRoleLayer()},i.show=function(t){this.reset(),this.onEvents(),this.node.active=!0,void 0!==t&&void 0!==t.data&&this.setData(t.data),this.nowCard=g.GoodsType.skin,this.chioseBtn(_.skin),this.updateCard(),this.addRoleLayer(),this.emit(m.LevelEvent.changeGoldPos,!1)},i.loadData=function(){this.GoodsData=b.getData("GoodsData")},i.onEvents=function(){this.on(m.LevelEvent.goodsUSE,this.goodsUSE,this)},i.goodsUSE=function(){for(var t=0;t<this.items.length;t++)this.items[t].refresh()},i.updateCard=function(){this.resetCard(),this.setCard()},i.setCard=function(){var t=this.getItemsNum();this.madeCard(t),this.goalNum=t,this.setpAddItem(!0)},i.getItemsNum=function(){return this.GoodsData[this.nowCard].num},i.madeCard=function(t){for(var e=Math.ceil(t/6),i=this.cards[0];this.cards.length<e;){var n=h(i);this.pageManage.addPage(n),this.cards.push(n)}},i.setpAddItem=function(t){var e=this;t&&(this.nowNum=0);var i=Math.floor(this.nowNum/6),n=this.cards[i];if(n){for(var a=0;a<6;a++){var o=n.getChildByName(String(a+1)),s=w.get(this.item.data.name);if(o.addChild(s),this.items.push(s[C]),this.addItem(),this.nowNum++,this.nowNum>=this.goalNum)return}setTimeout((function(){e.setpAddItem(!1)}),400)}},i.addItem=function(){if(this.nowCard!=g.GoodsType.weapon){var t=this.GoodsData[this.nowCard];this.items[this.nowNum].setData(t[String(this.nowNum+1)])}else{for(var e=this.GoodsData[this.nowCard],i=null,n=this.nowNum,a=0;a<this.weaponList.length;a++){var o=e[this.weaponList[a]];if(n<o.num){i=o[(n+1).toString()];break}n-=o.num}this.items[this.nowNum].setData(i)}},i.resetCard=function(){0!=this.items.length&&this.releaseItem(),this.cards.length>1&&this.releaseCard()},i.releaseItem=function(){for(;this.items.length>0;){var t=this.items.pop();w.put(t.node)}},i.releaseCard=function(){for(;this.cards.length>1;){var t=this.cards.pop();this.pageManage.removePage(t),t.destroy()}},i.chioseBtn=function(t){for(var e=0;e<this.btnSprs.length;e++)this.btnSprs[e].spriteFrame=e==t?this.chioseImg:this.defaultImg},i.onBtnSkin=function(){this.playClickBtn(),this.nowCard=g.GoodsType.skin,this.chioseBtn(_.skin),this.updateCard()},i.onBtnHat=function(){this.playClickBtn(),this.nowCard=g.GoodsType.hat,this.chioseBtn(_.hat),this.updateCard()},i.onBtnWeapon=function(){this.playClickBtn(),this.nowCard=g.GoodsType.weapon,this.chioseBtn(_.weapon),this.updateCard()},i.initRoleLayer=function(){},i.resetRoleLayer=function(){w.putAllChildren(this.roleLayer)},i.addRoleLayer=function(){var t=this,e=w.get("ShopRole");e?this.roleLayer.addChild(e):v.loadBundle("Role",(function(){v.loadBundleRes("Role","Prefab/ShopRole",(function(e){if(w.createPool(e.data.name,e,e.data.name),t.node.active&&0==t.roleLayer.children.length){var i=w.get("ShopRole");t.roleLayer.addChild(i)}}),n,!1)}),!1,!1)},i.onBtnExit=function(){this.playClickBtn(),this.emit(m.Common.UIEvent.exit,this.uiType),this.emit(m.LevelEvent.changeGoldPos,!0)},f(e,[{key:"uiType",get:function(){return g.UI.shop}}]),e}(y)).prototype,"item",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=l(P.prototype,"cards",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),z=l(P.prototype,"pageManage",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=l(P.prototype,"btnSprs",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),M=l(P.prototype,"defaultImg",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=l(P.prototype,"chioseImg",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=l(P.prototype,"roleLayer",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=P))||E));e._RF.pop()}}}));

System.register("chunks:///_virtual/TrySkinUI.ts",["cc","./_rollupPluginModLoBabelHelpers.js","./GameEventType.ts","./GlobalEnum.ts","./Action3dManager.ts","./yyComponent.ts","./PlayerData.ts","./Loader.ts","./GameData.ts"],(function(t){"use strict";var n,e,i,o,a,s,r,h,l,c,u,p,m,f,v,d,I,g;return{setters:[function(t){n=t.cclegacy,e=t._decorator,i=t.Node,o=t.Label,a=t.Sprite},function(t){s=t.applyDecoratedDescriptor,r=t.inheritsLoose,h=t.initializerDefineProperty,l=t.assertThisInitialized,c=t.defineProperty},function(t){u=t.EventType},function(t){p=t.GlobalEnum},function(t){m=t.default,f=t.ActionMngType},function(t){v=t.default},function(t){d=t.default},function(t){I=t.default},function(t){g=t.default}],execute:function(){var k,y,w,b,N,S,D,W,T,L,B,A,E;n._RF.push({},"d135ejL7AhEsKkP8rS0kNix","TrySkinUI",void 0);var C=e.ccclass,M=e.property;t("TrySkinUI",(k=C("TrySkinUI"),y=M(i),w=M(i),b=M(o),N=M(i),S=M(i),k((T=s((W=function(t){function n(){for(var n,e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return n=t.call.apply(t,[this].concat(i))||this,h(l(n),"weaponItems",T,l(n)),c(l(n),"weaponDatas",[]),c(l(n),"weaponList",["claw","knife","katana","gun","hunter","captain","trapper"]),h(l(n),"skinItems",L,l(n)),c(l(n),"skinDatas",[]),h(l(n),"titleLabel",B,l(n)),h(l(n),"btnNoWeapon",A,l(n)),h(l(n),"btnNo",E,l(n)),n}r(n,t);var e=n.prototype;return e.initSub=function(){this.initBtnNo(),this.initBtnNoWeapon(),this.initSkinItem(),this.initTitleLabel(),this.initWeaponItem()},e.resetSub=function(){this.resetBtnNo(),this.resetBtnNoWeapon(),this.resetSkinItem(),this.resetTitleLabel(),this.resetWeaponItem()},e.onEvents=function(){this.node.on(i.EventType.TOUCH_END,this.onNodeTouchEnd,this),this.on(u.LevelEvent.stopJoy,this.onStopJoy,this)},e.show=function(){this.node.active=!0,this.reset(),this.onEvents(),this.showWeaponItem()},e.runNodeScaleAction=function(t){var n=1;t.setScale(n,n,n),n+=.05;var e=m.scaleTo(.8,n,n,n);n-=.1;var i=m.scaleTo(.8,n,n,n),o=m.sequence(e,i),a=m.repeatForever(o);m.getMng(f.UI).runAction(t,a)},e.initWeaponItem=function(){for(var t=this,n=function(n){t.weaponItems[n].on(i.EventType.TOUCH_START,(function(){t.onClickWeapon(n)}))},e=this.weaponItems.length-1;e>=0;--e)n(e)},e.resetWeaponItem=function(){this.weaponDatas=[];for(var t=m.getMng(f.UI),n=this.weaponItems.length-1;n>=0;--n)t.stopAllActions(this.weaponItems[n]),this.weaponItems[n].active=!1;this.weaponItems[0].parent.active=!1},e.showWeaponItem=function(){var t=this;this.weaponItems[0].parent.active=!0;var n=this.getTowWeaponData();if((n=this.randomArry(n)).length>this.weaponItems.length){var e=Math.round(Math.random()*this.weaponItems.length);n.splice(e,1)}var i=n.length-1;i>=this.weaponItems.length&&(i=this.weaponItems.length-1),this.weaponDatas=[];for(var o=function(e){var i=n[e];t.weaponDatas.push({id:i.id,type:i.goodsType}),t.weaponItems[e].active=!0,t.loadImage(i.goodsType+i.id,(function(n){t.weaponItems[e].children[0].getComponent(a).spriteFrame=n}))},s=0;s<=i;++s)o(s);var r=Math.floor(Math.random()*(i-.001))+1;this.runNodeScaleAction(this.weaponItems[r]),this.setTitleLabel("请选择要使用的武器"),this.showBtnNoWeapon()},e.hideWeaponItem=function(){this.weaponItems[0].parent.active=!1},e.getTowWeaponData=function(){for(var t=this.weaponList,n=[],e=0;e<t.length;e++){var i=t[e],o=g.getData("GoodsData").weapon[i],a=d.getData("gameData.WeaponSkin.owned")[i];if(a.length<o.num){var s=o.num;a.indexOf(s)>=0&&n.unshift(o[s]);for(var r=[],h=0;h<s-1;h++)r.push(h+1);r=this.randomArry(r);for(var l=0;l<r.length;l++){a.indexOf(r[l])>=0&&n.push(o[r[l]])}}}return n},e.onClickWeapon=function(t){this.tryWeapon(this.weaponDatas[t])},e.tryWeapon=function(t){this.emit(u.Common.PlayerDataEvent.updatePlayerData,{attribute:"gameData.WeaponSkin.try",value:t,mode:"=",emit:!1,save:!1}),this.hideWeaponItem(),this.hideBtnNoWeapon(),this.showSkinItem(),this.showBtnNo()},e.initSkinItem=function(){for(var t=this,n=function(n){t.skinItems[n].on(i.EventType.TOUCH_START,(function(){t.onClickSkin(n)}))},e=this.skinItems.length-1;e>=0;--e)n(e)},e.resetSkinItem=function(){for(var t=m.getMng(f.UI),n=1;n<this.skinItems.length;++n)t.stopAllActions(this.skinItems[n]),this.skinItems[n].active=!1;this.skinItems[0].parent.active=!1},e.showSkinItem=function(){var t=this;this.skinItems[0].parent.active=!0;var n=d.getData("gameData.PlayerSkin.cur");this.loadImage("skin"+n,(function(n){t.skinItems[0].children[0].getComponent(a).spriteFrame=n})),this.skinDatas=[n];for(var e=[],i=d.getData("gameData.PlayerSkin.owned"),o=1;o<=18;++o)i.indexOf(o)<0&&e.push(o);var s=(e=this.randomArry(e)).length-1;s>=this.skinItems.length-1&&(s=this.skinItems.length-1);for(var r=function(n){t.skinDatas.push(e[n]),t.skinItems[n].active=!0,t.loadImage("skin"+e[n],(function(e){t.skinItems[n].children[0].getComponent(a).spriteFrame=e}))},h=1;h<=s;++h)r(h);var l=Math.floor(Math.random()*(s-.001))+1;this.runNodeScaleAction(this.skinItems[l]),this.setTitleLabel("免费试用皮肤")},e.onClickSkin=function(t){var n=this;t>0?this.emit(u.Common.SDKEvent.showVideo,{success:function(){n.trySkin(n.skinDatas[t])},fail:function(){}}):this.trySkin(this.skinDatas[t])},e.trySkin=function(t){this.emit(u.Common.PlayerDataEvent.updatePlayerData,{attribute:"gameData.PlayerSkin.try",value:t,mode:"=",emit:!1,save:!1}),this.startLevel()},e.initTitleLabel=function(){this.titleLabel.string=""},e.resetTitleLabel=function(){this.titleLabel.string=""},e.setTitleLabel=function(t){this.titleLabel.string=t},e.initBtnNoWeapon=function(){this.btnNoWeapon.active=!1},e.resetBtnNoWeapon=function(){this.btnNoWeapon.active=!1},e.showBtnNoWeapon=function(){this.btnNoWeapon.active=!0},e.hideBtnNoWeapon=function(){this.btnNoWeapon.active=!1},e.initBtnNo=function(){this.btnNo.active=!1},e.resetBtnNo=function(){this.btnNo.active=!1},e.hideBtnNo=function(){this.btnNo.active=!1},e.showBtnNo=function(){this.btnNo.active=!0},e.randomArry=function(t){for(var n=t.length,e=[],i=0;i<n;i++)e.push(i);for(var o=[],a=0;a<n;a++){var s=Math.floor(Math.random()*(e.length-.001)),r=e.splice(s,1)[0];o.push(t[r])}return o},e.loadImage=function(t,n){var e=this;I.loadBundleRes("UI","Image/shop/skin/"+t+"/spriteFrame",(function(t){n&&n.call(e,t)}))},e.startLevel=function(){this.hideUI(p.UI.trySkin),this.emit(u.LevelEvent.decideWeaponSkin)},e.onBtnNo=function(){this.playClickBtn(),this.startLevel()},e.onBtnNoWeapon=function(){this.hideWeaponItem(),this.hideBtnNoWeapon(),this.showSkinItem(),this.showBtnNo()},e.onStopJoy=function(t){t.y<320&&this.emit(u.Common.HeyGameSDK.clickNativeAd)},e.onNodeTouchEnd=function(t){var n=t.getUILocation();this.onStopJoy(n)},n}(v)).prototype,"weaponItems",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),L=s(W.prototype,"skinItems",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),B=s(W.prototype,"titleLabel",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=s(W.prototype,"btnNoWeapon",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=s(W.prototype,"btnNo",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=W))||D));n._RF.pop()}}}));

System.register("chunks:///_virtual/WinUI.ts",["cc","./_rollupPluginModLoBabelHelpers.js","./GameEventType.ts","./GlobalEnum.ts","./yyComponent.ts","./PlayerData.ts"],(function(t){"use strict";var n,e,i,o,a,s,r,l,u,h,c,d,m,f,g;return{setters:[function(t){n=t.cclegacy,e=t.Label,i=t.Node,o=t.UITransform,a=t._decorator},function(t){s=t.applyDecoratedDescriptor,r=t.inheritsLoose,l=t.initializerDefineProperty,u=t.assertThisInitialized,h=t.defineProperty,c=t.createClass},function(t){d=t.EventType},function(t){m=t.GlobalEnum},function(t){f=t.default},function(t){g=t.default}],execute:function(){var y,p,w,v,k,b,D,S,E,G,P,L;n._RF.push({},"d8843No3IJGf4jWUiXUAgX3","WinUI",void 0);var U=a,C=U.ccclass,R=U.property;t("default",(y=R(e),p=R(i),w=R(e),v=R(o),k=R(i),C((S=s((D=function(t){function n(){for(var n,e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return n=t.call.apply(t,[this].concat(i))||this,l(u(n),"goldLabel",S,u(n)),h(u(n),"gold",200),h(u(n),"awarded",!1),l(u(n),"skinAward",E,u(n)),l(u(n),"unlockPlan",G,u(n)),h(u(n),"unLockShow",!1),h(u(n),"maskHight",260),h(u(n),"nowRote",0),h(u(n),"goalRote",0),l(u(n),"maskUITrans",P,u(n)),l(u(n),"award",L,u(n)),n}r(n,t);var e=n.prototype;return e.init=function(t){this.initGold(),this.onEvents(),void 0!==t&&this.setData(t)},e.setData=function(t){this.gold=t.gold,this.goldLabel.string=this.gold.toString()},e.onEvents=function(){this.node.on(i.EventType.TOUCH_END,this.onNodeTouchEnd,this),this.on(d.LevelEvent.stopJoy,this.onStopJoy,this)},e.reset=function(){this.resetGold()},e.show=function(t){this.reset(),this.node.active=!0,void 0!==t&&void 0!==t.data&&this.setData(t.data),this.emit(d.Common.UIEvent.enter,m.UI.playerAssetBar),this.unlockSkin(),this.onEvents()},e.initGold=function(){this.awarded=!1,this.goldLabel.string=""},e.resetGold=function(){this.awarded=!1,this.goldLabel.string=""},e.continueGame=function(){this.awarded?this.enterLobby():this.addGold(this.gold,this.enterLobby.bind(this))},e.onBtnGetAward=function(){this.playClickBtn(),this.continueGame()},e.onBtnVideo=function(){this.playClickBtn(),this.getAwardByVideo()},e.getAwardByVideo=function(){var t=this;this.emit(d.Common.SDKEvent.showVideo,{success:function(){t.addGold(3*t.gold,t.getGoldByVideoFinish.bind(t))}})},e.getGoldByVideoFinish=function(){this.continueGame()},e.addGold=function(t,n){var e=this;this.emit(d.Common.UIEvent.playGoldAnim,{cb:function(){e.emit(d.Common.PlayerDataEvent.updatePlayerData,{attribute:"gameData.asset.gold",value:t,mode:"+",emit:!0,save:!0}),e.awarded=!0,n&&n()},gold:t})},e.enterLobby=function(){this.emit(d.Common.PlayerDataEvent.trySkinEnd),this.emit(d.Common.GameFlow.enterGameFlow,m.Common.GameFlowStep.recommendDialog)},e.onBtnMoreGame=function(){this.emit(d.Common.SDKEvent.showAppBox)},e.onBtnShare=function(){this.emit(d.Common.SDKEvent.shareToFriends)},e.unlockSkin=function(){var t=this,n=g.getData("gameData.unlockSkin");n<1?(this.skinAward.active=!0,this.nowRote=n,this.goalRote=n+.2,this.unLockShow=!1,this.unlockPlan.string=Math.floor(100*this.nowRote).toString(),this.maskUITrans.height=260*(1-this.nowRote),setTimeout((function(){t.unLockShow=!0}),1500)):(this.unLockShow=!1,this.skinAward.active=!1)},e.addUnlockPlan=function(){var t=g.getData("gameData.unlockSkin");t+=.2,this.emit(d.Common.PlayerDataEvent.updatePlayerData,{attribute:"gameData.unlockSkin",value:t,mode:"=",emit:!0,save:!0}),t>=1&&(this.award.active=!0,this.emit(d.Common.PlayerDataEvent.updatePlayerData,{attribute:"gameData.PlayerSkin.owned",value:17,mode:"push",emit:!0,save:!1}),this.emit(d.Common.PlayerDataEvent.updatePlayerData,{attribute:"gameData.PlayerSkin.cur",value:17,mode:"=",emit:!0,save:!0}))},e.update=function(t){this.unLockShow&&(this.nowRote<this.goalRote?(this.nowRote+=.2*t,this.unlockPlan.string=Math.floor(100*this.nowRote).toString(),this.maskUITrans.height=260*(1-this.nowRote)):(this.nowRote=this.goalRote,this.unlockPlan.string=Math.floor(100*this.nowRote).toString(),this.maskUITrans.height=260*(1-this.nowRote),this.unLockShow=!1,this.addUnlockPlan()))},e.onBtnExitAward=function(){this.award.active=!1},e.onStopJoy=function(t){t.y<320&&this.emit(d.Common.HeyGameSDK.clickNativeAd)},e.onNodeTouchEnd=function(t){var n=t.getUILocation();this.onStopJoy(n)},c(n,[{key:"uiType",get:function(){return m.UI.winUI}}]),n}(f)).prototype,"goldLabel",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=s(D.prototype,"skinAward",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=s(D.prototype,"unlockPlan",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=s(D.prototype,"maskUITrans",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=s(D.prototype,"award",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=D))||b));n._RF.pop()}}}));

System.register("chunks:///_virtual/MatchUI.ts",["cc","./_rollupPluginModLoBabelHelpers.js","./GameEventType.ts","./GlobalEnum.ts","./Action3dManager.ts","./GlobalData2.ts","./yyComponent.ts","./PlayerData.ts","./Loader.ts","./GlobalPool.ts","./GameData.ts","./LoopListH.ts"],(function(t){"use strict";var e,a,i,n,o,s,r,h,l,c,m,p,u,f,d,y,M,g,v,L,b,I;return{setters:[function(t){e=t.cclegacy,a=t._decorator,i=t.Node,n=t.SpriteFrame,o=t.Prefab,s=t.Sprite},function(t){r=t.applyDecoratedDescriptor,h=t.inheritsLoose,l=t.initializerDefineProperty,c=t.assertThisInitialized,m=t.defineProperty},function(t){p=t.EventType},function(t){u=t.GlobalEnum},function(t){f=t.default,d=t.ActionMngType},function(t){y=t.default},function(t){M=t.default},function(t){g=t.default},function(t){v=t.default},function(t){L=t.default},function(t){b=t.default},function(t){I=t.LoopListH}],execute:function(){var T,R,F,A,P,S,D,E,w,G,O;e._RF.push({},"dbefaMUdC1ANpL9arxUgUot","MatchUI",void 0);var C=a.ccclass,U=a.property;t("MatchUI",(T=C("MatchUI"),R=U(i),F=U(i),A=U(n),P=U(I),T((E=r((D=function(t){function e(){for(var e,a=arguments.length,i=new Array(a),n=0;n<a;n++)i[n]=arguments[n];return e=t.call.apply(t,[this].concat(i))||this,l(c(e),"roleLayer",E,c(e)),l(c(e),"enemiesLayer",w,c(e)),l(c(e),"emptyImg",G,c(e)),m(c(e),"matchPtr",0),m(c(e),"itemScale",1.2),m(c(e),"enemyMatchFinished",!1),l(c(e),"loopMap",O,c(e)),m(c(e),"mapOffset",0),m(c(e),"targetOffset",0),m(c(e),"spaceX",330),m(c(e),"mapIds",[]),m(c(e),"mapAnimRate",0),m(c(e),"mapAnimFinished",!1),e}h(e,t);var a=e.prototype;return a.initSub=function(){this.initEnemies(),this.initMap(),this.initRoleLayer()},a.resetSub=function(){this.resetEnemies(),this.resetMap(),this.resetRoleLayer()},a.show=function(){this.node.active=!0,this.reset(),this.addRoleLayer(),this.startMatch(),this.randomTargetMap()},a.initRoleLayer=function(){},a.resetRoleLayer=function(){L.putAllChildren(this.roleLayer)},a.addRoleLayer=function(){var t=this,e=L.get("ShopRole");e?this.roleLayer.addChild(e):v.loadBundle("Role",(function(){v.loadBundleRes("Role","Prefab/ShopRole",(function(e){if(L.createPool(e.data.name,e,e.data.name),t.node.active&&0==t.roleLayer.children.length){var a=L.get("ShopRole");t.roleLayer.addChild(a)}}),o,!1)}),!1,!1)},a.initEnemies=function(){this.enemyMatchFinished=!1},a.resetEnemies=function(){for(var t=this.enemiesLayer.children,e=t.length-1;e>=0;--e)t[e].getComponent(s).spriteFrame=this.emptyImg,t[e].setScale(1,1,1);this.matchPtr=0,this.enemyMatchFinished=!1},a.startMatch=function(){for(var t=[],e=0;e<10;++e)t.push(this.randomMatchEnemyData());y.set(u.myGlobalDataType.matchEnemies,t),this.matchPtr=0,this.enemiesLayer.children[this.matchPtr].setScale(this.itemScale,this.itemScale,this.itemScale),this.autoMatch()},a.autoMatch=function(){setTimeout(this.matchOne.bind(this),200+Math.round(100*Math.random()))},a.randomMatchEnemyData=function(){var t={},e=[u.WeaponType.captain,u.WeaponType.claw,u.WeaponType.gun,u.WeaponType.hunter,u.WeaponType.katana,u.WeaponType.knife,u.WeaponType.trapper],a=Math.floor(Math.random()*(e.length-.001));t.weaponType=e[a];var i=b.getData(u.GameDataType.GoodsData).weapon[e[a]].num;1==i||Math.random()>.9?t.weaponId=i:t.weaponId=Math.floor(Math.random()*(i-1.001))+1,Math.random()<.9?t.skin=Math.floor(11.999*Math.random())+1:t.skin=Math.floor(5.99*Math.random())+13;var n=0;return Math.random()>.8&&(n=Math.floor(16.99*Math.random())+1),t.hat=n,t},a.matchOne=function(){var t=this;this.emit(p.Common.AudioEvent.playEffect,u.AudioClip.gold);var e=this.enemiesLayer.children[this.matchPtr],a=y.get(u.myGlobalDataType.matchEnemies);if(v.loadBundleRes("UI","Image/shop/skin/skin"+a[this.matchPtr].skin+"/spriteFrame",(function(t){e.getComponent(s).spriteFrame=t;e.setScale(.5,.5,.5),e.active=!1,e.active=!0})),this.matchPtr++,this.matchPtr<a.length){var i=this.itemScale;this.enemiesLayer.children[this.matchPtr].setScale(i,i,i),this.autoMatch()}else setTimeout((function(){t.onMatchFinish()}),200)},a.onMatchFinish=function(){this.enemyMatchFinished=!0},a.initMap=function(){this.mapIds=[1,2,3,4,5,6];for(var t=[],e=0,a=this.mapIds.length;e<a;++e)t.push("mapImg"+this.mapIds[e]);this.loopMap.init({spaceX:this.spaceX,data:t}),this.mapOffset=0,this.mapAnimFinished=!1},a.resetMap=function(){this.loopMap.reset(),this.mapOffset=0,this.mapAnimFinished=!1},a.randomTargetMap=function(){var t,e=g.getData("gameData.curLevel"),a=e-1;e>this.mapIds.length&&(a=Math.floor(Math.random()*(this.mapIds.length-.001))),t=this.mapIds[a];var i=this.spaceX*this.mapIds.length;this.targetOffset=1.5*-i-t*this.spaceX+this.spaceX,y.set(u.myGlobalDataType.matchMap,t),this.mapAnimRate=0;var n=f.tweenTo(2,"mapAnimRate",1,!1);n.easing(f.easeInOut(2)),f.getMng(d.UI).runAction(this,n)},a.update=function(t){var e=this;if(this.mapAnimFinished)this.enemyMatchFinished&&(this.enemyMatchFinished=!1,setTimeout((function(){e.emit(p.LevelEvent.matchFinish)}),300));else{this.targetOffset*(1-this.mapAnimRate)>=-1&&(this.mapAnimRate=1,this.mapAnimFinished=!0);var a=this.targetOffset*this.mapAnimRate;this.loopMap.setOffset(a)}},e}(M)).prototype,"roleLayer",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=r(D.prototype,"enemiesLayer",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=r(D.prototype,"emptyImg",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=r(D.prototype,"loopMap",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=D))||S));e._RF.pop()}}}));

System.register("chunks:///_virtual/GetGoldByVideo.ts",["cc","./_rollupPluginModLoBabelHelpers.js","./GameEventType.ts","./GlobalEnum.ts","./yyComponent.ts"],(function(t){"use strict";var e,o,n,i,l,a,s,r;return{setters:[function(t){e=t.cclegacy,o=t._decorator},function(t){n=t.inheritsLoose,i=t.defineProperty,l=t.assertThisInitialized},function(t){a=t.EventType},function(t){s=t.GlobalEnum},function(t){r=t.default}],execute:function(){var c;e._RF.push({},"fef842K0ZRKf42sTjyQfY0c","GetGoldByVideo",void 0);var d=o.ccclass;o.property,t("GetGoldByVideo",d("GetGoldByVideo")(c=function(t){function e(){for(var e,o=arguments.length,n=new Array(o),a=0;a<o;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,i(l(e),"gold",1e3),e}n(e,t);var o=e.prototype;return o.onBtnGet=function(){var t=this;this.playClickBtn(),this.emit(a.Common.SDKEvent.showVideo,(function(){t.getGold()}))},o.getGold=function(){var t=this;this.emit(a.Common.UIEvent.playGoldAnim,{cb:function(){t.emit(a.Common.PlayerDataEvent.updatePlayerData,{attribute:"gameData.asset.gold",value:t.gold,mode:"+",emit:!0,save:!0}),t.hideUI(s.UI.getGoldByVideo)},gold:this.gold})},o.onBtnClose=function(){this.playClickBtn(),this.hideUI(s.UI.getGoldByVideo)},e}(r))||c);e._RF.pop()}}}));

System.register("chunks:///_virtual/UI",["./PlayerAssetBar.ts","./SkillBtn.ts","./LevelController.ts","./LevelInfoUI.ts","./AwardItem.ts","./LoseUI.ts","./Item.ts","./SpinUI.ts","./LoopListH.ts","./LoopListItem.ts","./ShopUI.ts","./TrySkinUI.ts","./WinUI.ts","./MatchUI.ts","./GetGoldByVideo.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

(function(r) {
  r('virtual:///prerequisite-imports/UI', 'chunks:///_virtual/UI'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});