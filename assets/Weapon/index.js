System.register("chunks:///_virtual/Trapper.ts",["cc","./_rollupPluginModLoBabelHelpers.js","./GameConfig.ts","./GameEventType.ts","./EventManager.ts","./GlobalEnum.ts","./LevelColler.ts"],(function(t){"use strict";var i,e,s,a,o,n,h,r,l,c,p,b;return{setters:[function(t){i=t.cclegacy,e=t._decorator,s=t.v3,a=t.Vec3},function(t){o=t.inheritsLoose,n=t.defineProperty,h=t.assertThisInitialized},function(t){r=t.default},function(t){l=t.EventType},function(t){c=t.default},function(t){p=t.GlobalEnum},function(t){b=t.default}],execute:function(){var u;i._RF.push({},"a45f2DIJA5PPocA4Da86N2k","Trapper",void 0);var d,y=e.ccclass;e.property,t("Trapper",y("Trapper")(u=function(t){function i(){for(var i,e=arguments.length,s=new Array(e),a=0;a<e;a++)s[a]=arguments[a];return i=t.call.apply(t,[this].concat(s))||this,n(h(i),"visible",!0),n(h(i),"atkRole",void 0),n(h(i),"speed",null),n(h(i),"cachePos",null),n(h(i),"scale",1),n(h(i),"audioClip",null),i}o(i,t);var e=i.prototype;return e.initSub=function(){this.initAABB(),this.initState()},e.resetSub=function(){this.resetAABB(),this.resetDirtyFlags(),this.resetState()},e.onEvents=function(){this.on(l.LevelEvent.dropTrapper,this.onDropTrapper,this)},e.registAllCustomUpdate=function(){this.registCustomUpdate(d.fly,this.stepFly)},e.setData=function(t){this.speed.set(t.speed),this.atkRole=t.role,this.scale=t.role.roleScale;var i=50*this.scale;this.node.setScale(i,i,i);var e=t.role.node.position;this.node.setPosition(e.x+.1*this.speed.x,this.scale,e.z+.1*this.speed.z),this.cachePos.set(this.node.position),this.setDirtyFlags(p.DirtyType.aabb),this.node.eulerAngles=s(),this.visible=!0,this.enterCustomUpdateState(d.fly)},e.initState=function(){this.visible=!0,this.atkRole=null,this.speed=new a,this.cachePos=new a,this.scale=1,this.setDirtyFlags(p.DirtyType.aabb)},e.resetState=function(){this.visible=!0,this.atkRole=null,this.scale=1,this.setDirtyFlags(p.DirtyType.aabb)},e.processDirty=function(){if(this.aabbDirty){this.aabbDirty=!1;var t=this.scale;this._aabb.xMin=t*this.minVert.x+this.node.position.x,this._aabb.xMax=t*this.maxVert.x+this.node.position.x,this._aabb.xScope=.5*(this._aabb.xMax-this._aabb.xMin),this._aabb.yMin=this.minVert.y+this.node.position.y,this._aabb.yMax=this.maxVert.y+this.node.position.y,this._aabb.yScope=this._aabb.yMax-this._aabb.yMin,this._aabb.zMin=t*this.minVert.z+this.node.position.z,this._aabb.zMax=t*this.maxVert.z+this.node.position.z,this._aabb.zScope=.5*(this._aabb.zMax-this._aabb.zMin),this._aabb.xCenter=this._aabb.xMin+this._aabb.xScope,this._aabb.yCenter=this._aabb.yMin+.5*this._aabb.yScope,this._aabb.zCenter=this._aabb.zMin+this._aabb.zScope,this._center.x=this._aabb.xCenter,this._center.y=this._aabb.yCenter,this._center.z=this._aabb.zCenter}},e.boom=function(t){void 0===t&&(t=!0),this.visible&&(this.visible=!1,this.emit(l.LevelEvent.addBoomEffect,{p:this.node.position,s:this.atkRole.roleScale}),this.emit(l.LevelEvent.addParticle,{n:"BoomParticle",p:this.node.position,s:this.scale}),t&&this.emit(l.Common.AudioEvent.playEffect,p.AudioClip.atkTrapperBoom))},e.onColled=function(t){this.atkRole.Id!=t.Id&&(t.collerType!=p.CollerType.role||!t.invicible&&t.isAlive)&&(this.boom(),this.hitSuccess(t))},e.hitSuccess=function(t){if(this.atkRole.hitSuccess(t),t.beHit(this),this.atkRole.isPlayer&&t.collerType==p.CollerType.barrier)switch(t.breakAudioType){case 0:this.audioClip=p.AudioClip.breakWood;break;case 1:this.audioClip=p.AudioClip.breakStones;break;case 2:this.audioClip=p.AudioClip.breakMetal}},e.processHitAudio=function(){this.audioClip&&this.atkRole.disToPlayerSqr<r.GameRule.enemyAudioScopeSqr&&c.emit(l.Common.AudioEvent.playEffect,this.audioClip),this.audioClip=null},e.stepFly=function(t){this.speed.y-=20*t,this.cachePos.x+=this.speed.x*t,this.cachePos.y+=this.speed.y*t,this.cachePos.z+=this.speed.z*t,this.cachePos.y<=0&&(this.cachePos.y=0,this.enterCustomUpdateState(d.stop)),this.node.setPosition(this.cachePos),this.setDirtyFlags(p.DirtyType.aabb)},e.onDropTrapper=function(t){this.visible&&t==this.atkRole.Id&&(this.boom(!1),this.emit(l.LevelEvent.removeTrapper,this))},i}(b))||u);!function(t){t[t.fly=0]="fly",t[t.stop=1]="stop",t[t.boom=2]="boom"}(d||(d={})),i._RF.pop()}}}));

System.register("chunks:///_virtual/Weapon",["./Trapper.ts"],(function(){"use strict";return{setters:[null],execute:function(){}}}));

(function(r) {
  r('virtual:///prerequisite-imports/Weapon', 'chunks:///_virtual/Weapon'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});